---
import Layout from "@/layouts/Layout.astro";
import type { GetStaticPaths } from "astro";
import { getCollection, type CollectionEntry } from "astro:content";
import SocialButton from "@/components/SocialButton.astro";
import AvatarImage from "@/components/AvatarImage.astro";

export const getStaticPaths = (async () => {
    const users = await getCollection("users");
    return users.map((user: CollectionEntry<'users'>) => ({
        params: { user: user.id },
        props: {user: user.data}
    }));
}) satisfies GetStaticPaths;

const { user } = Astro.props;

---
<Layout title="my-profile">
	<main class="container avatar-container">
        <AvatarImage
            avatar={user.avatar}
            name={user.name}
        />
        <section class="avatar-info">
            <h1>{ user.name }</h1>
            <p>{ user.description }</p>
        </section>
        <section class="social-media-container">
            {
                user.socialMedia.map((social) => (
                    <SocialButton
                        url={social.url}
                        name={social.name}
                    />
                ))
            }
        </section>
    </main>
</Layout>
<style>
    .avatar-container {
        margin-top: 5rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2rem;
        .avatar-image {
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
        }
        .avatar-info {
            text-align: center;
        }
        h1 {
            margin-bottom: 2rem;
        }
        p {
            padding: 0 5rem;
        } 
    }
    .social-media-container {
        margin-top: 3rem;
        display: flex;
        flex-direction: column;
        gap: 2rem;
    }
</style>